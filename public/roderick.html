<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>INTERSTELLAR PACKAGES</title>

  <!-- Stripe -->
  <script src="https://js.stripe.com/v3/"></script>

  <link rel="stylesheet" href="/css/header-layout.css">
  <link rel="stylesheet" href="/css/album-info.css">
  
  <style>
    /* OVERFLOW PROTECTION - Prevent horizontal scroll */
    html, body {
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      max-width: 100vw;
      width: 100%;
    }
    
    * {
      box-sizing: border-box;
    }
  </style>
</head>

<body data-math="on" data-page="roderick">
  <header class="header-system" id="artistHeader">
    <!-- CORRECT ORDER: Logo > Nav > Artist -->
    
    <div class="Logo header-logo" id="brandLogo" data-position="brandLogo">
      <img src="/images/IP_TAG24.svg" alt="Interstellar Packages Logo">
    </div>

    <nav class="Nav header-nav" id="topNav" data-position="topNav">
      <ul>
        <li><a href="filmography.html">Film</a></li>
        <li><a href="contact.html">Contact</a></li>
        <li class="loginSquare">
          <button id="loginBtn" class="login-button">Log In</button>
        </li>
        <li id="userInfo" class="user-info" style="display:none;">
          <span id="userName"></span>
          <button id="logoutBtn" class="logout-button">Logout</button>
        </li>
        <li class="cartSquare">
          <button id="cartBtn" class="cart-button">
            <img src="/images/IP-CART25-m1.svg" alt="Shopping Cart" class="cart-icon">
            <span id="cartCount" class="cart-count" style="display:none;">0</span>
          </button>
        </li>
      </ul>
    </nav>

    <div class="artist-name-container" id="artistName" data-position="artistName">
      <span id="artist-name" class="artist-name">Loading...</span>
    </div>
  </header>

  <main id="artistMain">
    <div class="album-art" id="albumsRegion">
      <!-- Albums are added directly here by ui-manager.js -->
    </div>

    <aside class="sidebar" id="infoRegion">
      <!-- Hidden on mobile, sidebar on desktop/tablet -->
      <details class="sidebar-details" open>
        <summary>Album Details</summary>
        <div class="sidebar-content" id="albumInfo" data-position="albumInfo"></div>
        <div id="songList" data-position="songList"></div>
      </details>
    </aside>
  </main>

  <footer id="artistControls">
    <details class="footer-details" open>
      <summary>Player</summary>
      <div class="foot-cont">
        <div class="player" id="playerControls" data-position="playerControls"></div>
        <p class="footTag">&copy; 2024/25 RDXENV</p>
      </div>
    </details>
  </footer>

  <!-- System + app modules (order matters for ESM dependencies) -->
  <script type="module" src="/js/InterstellarSystem.js"></script>
  <script type="module" src="/js/api-client.js"></script>
  <script type="module" src="/js/ui-manager.js"></script>
  <script type="module" src="/js/main.js"></script>
  <script type="module" src="/js/header.js"></script>

  <!-- Legacy globals -->
  <script src="/js/auth.js"></script>
  <script src="/js/cart.js"></script>
  <script src="/js/player.js"></script>

  <!-- Paint first, then page controller -->
  <script type="module" src="/js/paint-applier.js"></script>
  <script type="module" src="/js/roderick.js"></script>

  <!-- Overlays (hidden by default without CSS) -->
  <section id="playerOverlay" aria-hidden="true" style="display:none;"></section>
  <section id="userOverlay" aria-hidden="true" style="display:none;"></section>

  <!-- Auth Modal (hidden by default without CSS) -->
  <div id="authModal" class="auth-modal" style="display:none;">
    <div class="auth-modal-content">
      <span class="close"></span>

      <div id="loginForm" class="auth-form-container">
        <h2>Log In</h2>
        <div id="loginError" class="auth-error" style="display:none;"></div>
        <form class="auth-form" id="loginFormElement">
          <input type="email" id="loginEmail" placeholder="Email" required>
          <div class="password-input-container">
            <input type="password" id="loginPassword" placeholder="Password" required>
            <div class="password-toggle-icon" data-target="loginPassword"></div>
          </div>
          <button type="submit" id="loginSubmit">Log In</button>
        </form>
        <div class="form-toggle">
          Don't have an account? <a id="showRegister">Create one</a>
        </div>
      </div>

      <div id="registerForm" class="auth-form-container" style="display:none;">
        <h2>Create Account</h2>
        <div id="registerError" class="auth-error" style="display:none;"></div>
        <div id="registerSuccess" class="auth-success" style="display:none;"></div>
        <form class="auth-form" id="registerFormElement">
          <input type="text" id="registerUsername" placeholder="Username" required>
          <input type="text" id="registerFirstName" placeholder="First Name">
          <input type="text" id="registerLastName" placeholder="Last Name">
          <input type="email" id="registerEmail" placeholder="Email" required>
          <div class="password-input-container">
            <input type="password" id="registerPassword" placeholder="Password (min 6 characters)" required>
            <div class="password-toggle-icon" data-target="registerPassword"></div>
          </div>
          <button type="submit" id="registerSubmit">Create Account</button>
        </form>
        <div class="form-toggle">
          Already have an account? <a id="showLogin">Log in</a>
        </div>
      </div>
    </div>
  </div>
</body>
</html>